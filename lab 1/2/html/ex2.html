
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>ex2</title><meta name="generator" content="MATLAB 8.0"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2014-04-02"><meta name="DC.source" content="ex2.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1></h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Ex2.2</a></li><li><a href="#7">Ex2.3 - a)</a></li><li><a href="#10">Ex2.3 - b)</a></li><li><a href="#12">Ex2.3 - c)</a></li><li><a href="#14">Ex2.3 - d)</a></li></ul></div><h2>Ex2.2<a name="1"></a></h2><pre class="codeinput">y=zeros(6,1);
M1=[1   1   1   1;
    1   1   1   1;
    -1 -1  -1  -1;
    1   1   1   1;
    1   1   1   1;
    1  1.1 0.5 0.1];

M2=[1    1    1   1;
    1    1    1   1;
   -2   -2   -3  -3;
    2    4    6   6;
    1    3    4   9;
    1    3    4   9];

<span class="comment">% As colunas de M1/M2 correspondem aos valores dos par&acirc;metros a fornecer</span>
<span class="comment">% &agrave; simula&ccedil;&atilde;o. Iterar pelas colunas da matriz fornece ent&atilde;o os v&aacute;ros</span>
<span class="comment">% exemplos necess&aacute;rios</span>
<span class="comment">%</span>
<span class="comment">% As primeiras duas linhas correspondem a alfa1 e alfa2, que neste</span>
<span class="comment">% exerc&iacute;cio devem ser mantidos a 1</span>

<span class="keyword">for</span> y=M1

    alpha1=y(1);alpha2=y(2);delta1=y(3);delta2=y(4);N1_0=y(5);N2_0=y(6);
    options = simset(<span class="string">'SrcWorkspace'</span>,<span class="string">'current'</span>);
    sim(<span class="string">'function_teste'</span>,[],options);

    figure;
    hold <span class="string">on</span>;

    plot(tout,n1,<span class="string">'b'</span>);
    plot(tout,n2,<span class="string">'g'</span>);

    title([<span class="string">'Modelo predador presa (2.2) - varia&ccedil;&atilde;o das condi&ccedil;&otilde;es iniciais\newline\alpha_1='</span>,num2str(alpha1),<span class="string">'   \alpha_2='</span>,num2str(alpha2),<span class="string">'  \delta_1='</span>,num2str(delta1),<span class="string">'   \delta_2='</span>,num2str(delta2),<span class="string">'   N_1(0)='</span>,num2str(N1_0),<span class="string">'   N_2(0)='</span>,num2str(N2_0),<span class="string">'   Ponto de Equil&iacute;brio: N_1='</span>,num2str(-delta1/alpha1),<span class="string">' ;  N_2='</span>,num2str(delta2/alpha2)]);
    legend(<span class="string">'N_1'</span>,<span class="string">'N_2'</span>);

    m=max(max(n1),max(n2))+1;
    axis([0 10 0 m]);

    xlabel(<span class="string">'Time (t)'</span>);
    ylabel(<span class="string">'N_1 / N_2'</span>);

    hold <span class="string">off</span>;

<span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="ex2_01.png" alt=""> <img vspace="5" hspace="5" src="ex2_02.png" alt=""> <img vspace="5" hspace="5" src="ex2_03.png" alt=""> <img vspace="5" hspace="5" src="ex2_04.png" alt=""> <p>A partir dos primeiros gr&aacute;ficos, pode concluir-se o seguinte</p><div><ul><li>Quando ambas as condi&ccedil;&otilde;es iniciais correspondem ao equil&iacute;brio, as popula&ccedil;&otilde;es nunca oscilam e mant&ecirc;m sempre o equil&iacute;brio (assumimos que n&atilde;o h&aacute; perturba&ccedil;&otilde;es), tal como esperado</li><li>Ao "desequilibrar" uma das condi&ccedil;&otilde;es iniciais, as popula&ccedil;&otilde;es passam a seguir um modelo oscilat&oacute;rio, sendo que o aumento da amplitude das popula&ccedil;&otilde;es torna mais vis&iacute;vel a varia&ccedil;&atilde;o lenta perto dos m&iacute;nimos e r&aacute;pida perto dos m&aacute;ximos, tal como esperado da an&aacute;lise te&oacute;rica</li><li>Ao manter um dos valores iniciais no equil&iacute;brio, o outro valor inicial passa a definir o m&aacute;ximo ou o m&iacute;nimo, conforme acima ou abaixo do valor de equil&iacute;brio, respectivamente</li></ul></div><pre class="codeinput"><span class="keyword">for</span> y=M2

    alpha1=y(1);alpha2=y(2);delta1=y(3);delta2=y(4);N1_0=y(5);N2_0=y(6);
    options = simset(<span class="string">'SrcWorkspace'</span>,<span class="string">'current'</span>);
    sim(<span class="string">'function_teste'</span>,[],options);

    figure;
    hold <span class="string">on</span>;

    plot(tout,n1,<span class="string">'b'</span>);
    plot(tout,n2,<span class="string">'g'</span>);

    title([<span class="string">'Modelo predador presa (2.2) - varia&ccedil;&atilde;o dos pontos de equil&iacute;brio/m&aacute;ximos/m&iacute;nimos\newline\alpha_1='</span>,num2str(alpha1),<span class="string">'   \alpha_2='</span>,num2str(alpha2),<span class="string">'  \delta_1='</span>,num2str(delta1),<span class="string">'   \delta_2='</span>,num2str(delta2),<span class="string">'   N_1(0)='</span>,num2str(N1_0),<span class="string">'   N_2(0)='</span>,num2str(N2_0),<span class="string">'   Ponto de Equil&iacute;brio: N_1='</span>,num2str(-delta1/alpha1),<span class="string">' ;  N_2='</span>,num2str(delta2/alpha2)]);
    legend(<span class="string">'N_1'</span>,<span class="string">'N_2'</span>);

    m=max(max(n1),max(n2))+1;
    axis([0 10 0 m]);

    xlabel(<span class="string">'Time (t)'</span>);
    ylabel(<span class="string">'N_1 / N_2'</span>);

    hold <span class="string">off</span>;

<span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="ex2_05.png" alt=""> <img vspace="5" hspace="5" src="ex2_06.png" alt=""> <img vspace="5" hspace="5" src="ex2_07.png" alt=""> <img vspace="5" hspace="5" src="ex2_08.png" alt=""> <p>Nestes exemplos podem ver-se essencialmente os efeitos da varia&ccedil;&atilde;o dos par&acirc;metros alfa e delta em particular, mantendo as condi&ccedil;&otilde;es iniciais iguais.</p><div><ul><li>&Eacute; de notar o afastamento das solu&ccedil;&otilde;es com o afastamento dos valores de delta, o que demontra a depend&ecirc;ncia directa entre este par&acirc;metro e o valor de equil&iacute;brio (mantendo alfa constante)</li><li>Entre os dois &uacute;ltimos gr&aacute;ficos pode notar-se a diferen&ccedil;a das amplitues face &agrave; varia&ccedil;&atilde;o simult&acirc;nea das condi&ccedil;&otilde;es iniciais</li><li>O primeiro caso representa uma situa&ccedil;&atilde;o em que o valor inicial &eacute; superior ao valor de equil&iacute;brio da popula&ccedil;&atilde;o de presas e inferior ao da popula&ccedil;&atilde;o de predadores</li><li>No segundo caso o valor inicial &eacute; superior a ambos os pontos de equil&iacute;brio)</li></ul></div><p>Em rela&ccedil;&atilde;o ao gr&aacute;fico obtido em 2.1, podemos verificar a semelhan&ccedil;a na forma da varia&ccedil;&atilde;o das popula&ccedil;&otilde;es, fazendo-se uma compara&ccedil;&atilde;o directa com o primeiro do segundo grupo de figuras, pois os valores utilizados para os par&acirc;metros s&atilde;o os mesmos.</p><h2>Ex2.3 - a)<a name="7"></a></h2><pre class="codeinput"><span class="comment">%Tentativa 1</span>
y1=[1.2;1.2;-1.2;2.3;10;10];

<span class="comment">%Tentativa 2</span>
y2=[1.2;1.2;-1.2;2.3;1.9167;10];

<span class="comment">%Tentativa 3</span>
y3=[0.6;1.2;-1.2;2.3;1.9167;10];

<span class="comment">%Tentativa 4</span>
y4=[0.55;1.2;-1.2;2.3;1.9167;10];

y=zeros(6,1);
M=[y1 y2 y3 y4];

<span class="keyword">for</span> y=M

    alpha1=y(1);alpha2=y(2);delta1=y(3);delta2=y(4);N1_0=y(5);N2_0=y(6);

    load(<span class="string">'presas.mat'</span>);
    options = simset(<span class="string">'SrcWorkspace'</span>,<span class="string">'current'</span>);
    sim(<span class="string">'function_teste'</span>, tr,options);

    figure;
    hold <span class="string">on</span>;

    plot(tout,n1,<span class="string">'b'</span>);
    plot(tout,n2,<span class="string">'g'</span>);
    plot(tr,yr,<span class="string">'r'</span>);

    title([<span class="string">'Modelo predador presa (2.3) - C&aacute;lculo de modelo por tentativa\newline\alpha_1='</span>,num2str(alpha1),<span class="string">'   \alpha_2='</span>,num2str(alpha2),<span class="string">'  \delta_1='</span>,num2str(delta1),<span class="string">'   \delta_2='</span>,num2str(delta2),<span class="string">'   N_1(0)='</span>,num2str(N1_0),<span class="string">'   N_2(0)='</span>,num2str(N2_0),<span class="string">'\newlinePonto de Equil&iacute;brio: N_1='</span>,num2str(-delta1/alpha1),<span class="string">' ;  N_2='</span>,num2str(delta2/alpha2)]);
    legend(<span class="string">'N_1'</span>,<span class="string">'N_2'</span>,<span class="string">'N_2(file)'</span>);

    m=max(max(n1),max(n2))+1;
    axis([0 20 0 m]);

    xlabel(<span class="string">'Time (t)'</span>);
    ylabel(<span class="string">'N_1 / N_2'</span>);

    hold <span class="string">off</span>;

<span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="ex2_09.png" alt=""> <img vspace="5" hspace="5" src="ex2_10.png" alt=""> <img vspace="5" hspace="5" src="ex2_11.png" alt=""> <img vspace="5" hspace="5" src="ex2_12.png" alt=""> <p>Figura 9: Ap&oacute;s observa&ccedil;&atilde;o dos valores fornecidos come&ccedil;ou por escolher-se os par&acirc;metros alfa1 e a condi&ccedil;&atilde;o inicial dos predadores iguais aos valores conhecidos das presas</p><p>Figura 10: De seguida, sendo o m&aacute;ximo dos valores observados 10, tal como o valor inicial da popula&ccedil;&atilde;o de presas, baixou-se o valor inicial da popula&ccedil;&atilde;o de predadores para igualar o ponto de equil&iacute;brio da popula&ccedil;&atilde;o das presas(em 2.1 e 2.2-a vimos que para que a condi&ccedil;&atilde;o inicial de uma popula&ccedil;&atilde;o seja um extremo, a condi&ccedil;&atilde;o inicial da popula&ccedil;&atilde;o concorrente deve ser o ponto de equil&iacute;brio da anterior)</p><p>Figura 11: Variando alfa1 (passando por outros valores n&atilde;o exemplificados) concluiu-se que colocando o mesmo a metade de delta1, as popula&ccedil;&otilde;es dada e calculada come&ccedil;am a sobrep&ocirc;r-se</p><p>Figura 12: De forma a optimizar a sobreposi&ccedil;&atilde;o nas primeiras arcadas, variou-se ligeiramente alfa1 no sentido anterior; no entanto, ambas &uacute;ltimas figuras representam uma sobreposi&ccedil;&atilde;o adequada dos valores fornecidos e do modelo calculado</p><p>O m&iacute;nimo encontrado por tentativa e erro ocorre em alfa1 = 0.55  and N1(0) = 1.9167</p><h2>Ex2.3 - b)<a name="10"></a></h2><pre class="codeinput">n2=zeros(1,101);
yr=zeros(1,101);

[X,Y] = meshgrid(2:((2.9-2)/20):2.9, 0.56:((0.58-0.56)/20):0.58);
s=size(X);
l=s(1);
c=s(2);
E=zeros(l,c);

<span class="keyword">for</span> i=1:1:l
    <span class="keyword">for</span> j=1:1:c

        y=[X(i,j) Y(i,j)];
        E(i,j)=func_error(y);

    <span class="keyword">end</span>

    <span class="comment">%tempo_restante = waitbar(i/l);</span>

<span class="keyword">end</span>
figure;
h=surf(X,Y,E);
[x_b,y_b]=find(E==min(min(E)));

title(<span class="string">'Error surface'</span>);
xlabel(<span class="string">'N_1(0)'</span>);
ylabel(<span class="string">'\alpha_1'</span>);
zlabel(<span class="string">'Error'</span>);
<span class="comment">%shading interp;</span>
</pre><img vspace="5" hspace="5" src="ex2_13.png" alt=""> <h2>Ex2.3 - c)<a name="12"></a></h2><pre class="codeinput">x0=[1.9167 0.55];
options = optimset(<span class="string">'TolX'</span>,1e-12);
[x_c,fval_c] = fminsearch(@func_error,x0,options);
</pre><h2>Ex2.3 - d)<a name="14"></a></h2><pre class="codeinput">    alpha1=Y(x_b,y_b);
    alpha2=1.2;
    delta1=-1.2;
    delta2=2.3;
    N1_0=X(x_b,y_b);
    N2_0=10;

  load(<span class="string">'presas.mat'</span>);
  options = simset(<span class="string">'SrcWorkspace'</span>,<span class="string">'current'</span>);
  sim(<span class="string">'function_teste'</span>, tr,options);

  figure;
  hold <span class="string">on</span>;

  plot(tout,n2,<span class="string">'g'</span>);
  plot(tr,yr,<span class="string">'ro'</span>);

   title([<span class="string">'Modelo predador presa (2.3)- (b/d) Solu&ccedil;&atilde;o de modelo por m&iacute;nimo de superf&iacute;cie\newline\alpha_1='</span>,num2str(alpha1),<span class="string">' \alpha_2='</span>,num2str(alpha2),<span class="string">' \delta_1='</span>,num2str(delta1),<span class="string">' \delta_2='</span>,num2str(delta2),<span class="string">' N_1(0)='</span>,num2str(N1_0),<span class="string">' N_2(0)='</span>,num2str(N2_0),<span class="string">'\newlinePonto de Equil&iacute;brio: N_1='</span>,num2str(-delta1/alpha1),<span class="string">' ; N_2='</span>,num2str(delta2/alpha2)]);
   legend(<span class="string">'N_2'</span>,<span class="string">'N_2(file)'</span>);

  m=max(max(n1),max(n2))+1;
  axis([0 20 0 m]);

  xlabel(<span class="string">'Time (t)'</span>);
  ylabel(<span class="string">'N_1 / N_2'</span>);

  E(x_b,y_b);
  hold <span class="string">off</span>;
</pre><img vspace="5" hspace="5" src="ex2_14.png" alt=""> <p>O m&iacute;nimo com ciclos for &eacute; 12.1014 alfa1 = 0.5710 e N1(0) = 2.5850</p><pre class="codeinput">    alpha1=x_c(2);
    alpha2=1.2;
    delta1=-1.2;
    delta2=2.3;
    N1_0=x_c(1);
    N2_0=10;

  load(<span class="string">'presas.mat'</span>);
  options = simset(<span class="string">'SrcWorkspace'</span>,<span class="string">'current'</span>);
  sim(<span class="string">'function_teste'</span>, tr,options);

  figure;
  hold <span class="string">on</span>;

  plot(tout,n2,<span class="string">'g'</span>);
  plot(tr,yr,<span class="string">'ro'</span>);

  title([<span class="string">'Modelo predador presa (2.3) - (c/d) Solu&ccedil;&atilde;o de modelo por optimiza&ccedil;&atilde;o de procura\newline\alpha_1='</span>,num2str(alpha1),<span class="string">' \alpha_2='</span>,num2str(alpha2),<span class="string">' \delta_1='</span>,num2str(delta1),<span class="string">' \delta_2='</span>,num2str(delta2),<span class="string">' N_1(0)='</span>,num2str(N1_0),<span class="string">' N_2(0)='</span>,num2str(N2_0),<span class="string">'\newlinePonto de Equil&iacute;brio: N_1='</span>,num2str(-delta1/alpha1),<span class="string">' ; N_2='</span>,num2str(delta2/alpha2)]);
  legend(<span class="string">'N_2'</span>,<span class="string">'N_2(file)'</span>);

  m=max(max(n1),max(n2))+1;
  axis([0 20 0 m]);

  xlabel(<span class="string">'Time (t)'</span>);
  ylabel(<span class="string">'N_1 / N_2'</span>);

  hold <span class="string">off</span>;
</pre><img vspace="5" hspace="5" src="ex2_15.png" alt=""> <p>O m&iacute;nimo do erro atrav&eacute;s de optimiza&ccedil;&atilde;o &eacute;  12.0533 para alfa1 = 0.5715 e N1(0) = 2.5740</p><p>Os valores obtidos foram muito semelhantes para ambas as al&iacute;neas. No entanto, o segundo m&eacute;todo &eacute; mais eficiente, visto que o primero envolve a escolha de uma grelha e diminui&ccedil;&atilde;o da mesma por observa&ccedil;&atilde;o, e a procura do m&iacute;nimo na matriz de erro resultante. Esta simula&ccedil;&atilde;o com o uso dos ciclos 'for' &eacute; um processo demorado e com tempo de c&aacute;lculo para cada matriz a evoluir quadraticamente com as dimens&otilde;es da mesma.</p><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2012b</a><br></p></div><!--
##### SOURCE BEGIN #####

%% Ex2.2

%%
y=zeros(6,1);
M1=[1   1   1   1;
    1   1   1   1;
    -1 -1  -1  -1;
    1   1   1   1; 
    1   1   1   1; 
    1  1.1 0.5 0.1];

M2=[1    1    1   1;
    1    1    1   1;
   -2   -2   -3  -3;
    2    4    6   6; 
    1    3    4   9; 
    1    3    4   9];

% As colunas de M1/M2 correspondem aos valores dos parâmetros a fornecer
% à simulação. Iterar pelas colunas da matriz fornece então os város
% exemplos necessários
%
% As primeiras duas linhas correspondem a alfa1 e alfa2, que neste
% exercício devem ser mantidos a 1

for y=M1
    
    alpha1=y(1);alpha2=y(2);delta1=y(3);delta2=y(4);N1_0=y(5);N2_0=y(6);
    options = simset('SrcWorkspace','current');
    sim('function_teste',[],options);

    figure;
    hold on;

    plot(tout,n1,'b');
    plot(tout,n2,'g');

    title(['Modelo predador presa (2.2) - variação das condições iniciais\newline\alpha_1=',num2str(alpha1),'   \alpha_2=',num2str(alpha2),'  \delta_1=',num2str(delta1),'   \delta_2=',num2str(delta2),'   N_1(0)=',num2str(N1_0),'   N_2(0)=',num2str(N2_0),'   Ponto de Equilíbrio: N_1=',num2str(-delta1/alpha1),' ;  N_2=',num2str(delta2/alpha2)]);
    legend('N_1','N_2');

    m=max(max(n1),max(n2))+1;
    axis([0 10 0 m]);

    xlabel('Time (t)');
    ylabel('N_1 / N_2');

    hold off;

end
%%
%
% A partir dos primeiros gráficos, pode concluir-se o seguinte
% 
% * Quando ambas as condições iniciais correspondem ao equilíbrio, as populações nunca oscilam e mantêm sempre o equilíbrio (assumimos que não há perturbações), tal como esperado
% * Ao "desequilibrar" uma das condições iniciais, as populações passam a seguir um modelo oscilatório, sendo que o aumento da amplitude das populações torna mais visível a variação lenta perto dos mínimos e rápida perto dos máximos, tal como esperado da análise teórica
% * Ao manter um dos valores iniciais no equilíbrio, o outro valor inicial passa a definir o máximo ou o mínimo, conforme acima ou abaixo do valor de equilíbrio, respectivamente

%%
for y=M2
    
    alpha1=y(1);alpha2=y(2);delta1=y(3);delta2=y(4);N1_0=y(5);N2_0=y(6);
    options = simset('SrcWorkspace','current');
    sim('function_teste',[],options);

    figure;
    hold on;

    plot(tout,n1,'b');
    plot(tout,n2,'g');

    title(['Modelo predador presa (2.2) - variação dos pontos de equilíbrio/máximos/mínimos\newline\alpha_1=',num2str(alpha1),'   \alpha_2=',num2str(alpha2),'  \delta_1=',num2str(delta1),'   \delta_2=',num2str(delta2),'   N_1(0)=',num2str(N1_0),'   N_2(0)=',num2str(N2_0),'   Ponto de Equilíbrio: N_1=',num2str(-delta1/alpha1),' ;  N_2=',num2str(delta2/alpha2)]);
    legend('N_1','N_2'); 

    m=max(max(n1),max(n2))+1;
    axis([0 10 0 m]);

    xlabel('Time (t)');
    ylabel('N_1 / N_2');

    hold off;

end

%%
% 
% Nestes exemplos podem ver-se essencialmente os efeitos da variação dos parâmetros alfa e delta em particular, mantendo as condições iniciais iguais.
% 
% * É de notar o afastamento das soluções com o afastamento dos valores de delta, o que demontra a dependência directa entre este parâmetro e o valor de equilíbrio (mantendo alfa constante)
% * Entre os dois últimos gráficos pode notar-se a diferença das amplitues face à variação simultânea das condições iniciais
% * O primeiro caso representa uma situação em que o valor inicial é superior ao valor de equilíbrio da população de presas e inferior ao da população de predadores
% * No segundo caso o valor inicial é superior a ambos os pontos de equilíbrio)

%%
% 
% Em relação ao gráfico obtido em 2.1, podemos verificar a semelhança na
% forma da variação das populações, fazendo-se uma comparação directa
% com o primeiro do segundo grupo de figuras, pois os valores utilizados
% para os parâmetros são os mesmos. 
% 

%% Ex2.3 - a)

%%

%Tentativa 1
y1=[1.2;1.2;-1.2;2.3;10;10]; 

%Tentativa 2
y2=[1.2;1.2;-1.2;2.3;1.9167;10]; 

%Tentativa 3
y3=[0.6;1.2;-1.2;2.3;1.9167;10]; 

%Tentativa 4
y4=[0.55;1.2;-1.2;2.3;1.9167;10]; 

y=zeros(6,1);
M=[y1 y2 y3 y4];

for y=M

    alpha1=y(1);alpha2=y(2);delta1=y(3);delta2=y(4);N1_0=y(5);N2_0=y(6);
       
    load('presas.mat');
    options = simset('SrcWorkspace','current');
    sim('function_teste', tr,options);

    figure;
    hold on;

    plot(tout,n1,'b');
    plot(tout,n2,'g');
    plot(tr,yr,'r');

    title(['Modelo predador presa (2.3) - Cálculo de modelo por tentativa\newline\alpha_1=',num2str(alpha1),'   \alpha_2=',num2str(alpha2),'  \delta_1=',num2str(delta1),'   \delta_2=',num2str(delta2),'   N_1(0)=',num2str(N1_0),'   N_2(0)=',num2str(N2_0),'\newlinePonto de Equilíbrio: N_1=',num2str(-delta1/alpha1),' ;  N_2=',num2str(delta2/alpha2)]);
    legend('N_1','N_2','N_2(file)');

    m=max(max(n1),max(n2))+1;
    axis([0 20 0 m]);

    xlabel('Time (t)');
    ylabel('N_1 / N_2');

    hold off;
    
end

%%
%
% Figura 9: 
% Após observação dos valores fornecidos começou por escolher-se os parâmetros alfa1 e a condição inicial dos predadores iguais aos valores conhecidos das presas
% 
% Figura 10: 
% De seguida, sendo o máximo dos valores observados 10, tal como o valor inicial da população de presas, baixou-se o valor inicial da população de predadores para igualar o ponto de equilíbrio da população das presas(em 2.1 e 2.2-a vimos que para que a condição inicial de uma população seja um extremo, a condição inicial da população concorrente deve ser o ponto de equilíbrio da anterior)
% 
% Figura 11: 
% Variando alfa1 (passando por outros valores não exemplificados) concluiu-se que colocando o mesmo a metade de delta1, as populações dada e calculada começam a sobrepôr-se
% 
% Figura 12: 
% De forma a optimizar a sobreposição nas primeiras arcadas, variou-se ligeiramente alfa1 no sentido anterior; no entanto, ambas últimas figuras representam uma sobreposição adequada dos valores fornecidos e do modelo calculado
% 
% 
% O mínimo encontrado por tentativa e erro ocorre em alfa1 = 0.55  and N1(0) = 1.9167
       

%% Ex2.3 - b)
%%

n2=zeros(1,101);
yr=zeros(1,101);

[X,Y] = meshgrid(2:((2.9-2)/20):2.9, 0.56:((0.58-0.56)/20):0.58); 
s=size(X);
l=s(1);
c=s(2);
E=zeros(l,c);

for i=1:1:l
    for j=1:1:c
        
        y=[X(i,j) Y(i,j)];
        E(i,j)=func_error(y);

    end
   
    %tempo_restante = waitbar(i/l);
    
end
figure;
h=surf(X,Y,E);
[x_b,y_b]=find(E==min(min(E)));

title('Error surface');
xlabel('N_1(0)');
ylabel('\alpha_1');
zlabel('Error');
%shading interp;


%% Ex2.3 - c)

%%
x0=[1.9167 0.55];
options = optimset('TolX',1e-12);
[x_c,fval_c] = fminsearch(@func_error,x0,options);
  
%% Ex2.3 - d)

%%

  
    alpha1=Y(x_b,y_b);
    alpha2=1.2;
    delta1=-1.2;
    delta2=2.3;
    N1_0=X(x_b,y_b);
    N2_0=10;

  load('presas.mat');
  options = simset('SrcWorkspace','current');
  sim('function_teste', tr,options);

  figure;
  hold on;

  plot(tout,n2,'g');
  plot(tr,yr,'ro');

   title(['Modelo predador presa (2.3)- (b/d) Solução de modelo por mínimo de superfície\newline\alpha_1=',num2str(alpha1),' \alpha_2=',num2str(alpha2),' \delta_1=',num2str(delta1),' \delta_2=',num2str(delta2),' N_1(0)=',num2str(N1_0),' N_2(0)=',num2str(N2_0),'\newlinePonto de Equilíbrio: N_1=',num2str(-delta1/alpha1),' ; N_2=',num2str(delta2/alpha2)]);
   legend('N_2','N_2(file)');

  m=max(max(n1),max(n2))+1;
  axis([0 20 0 m]);

  xlabel('Time (t)');
  ylabel('N_1 / N_2');

  E(x_b,y_b);
  hold off;
  
    
 %%
 %
 % O mínimo com ciclos for é 12.1014 alfa1 = 0.5710 e N1(0) = 2.5850
 %
 %%

    alpha1=x_c(2);
    alpha2=1.2;
    delta1=-1.2;
    delta2=2.3;
    N1_0=x_c(1);
    N2_0=10;

  load('presas.mat');
  options = simset('SrcWorkspace','current');
  sim('function_teste', tr,options);

  figure;
  hold on;

  plot(tout,n2,'g');
  plot(tr,yr,'ro');

  title(['Modelo predador presa (2.3) - (c/d) Solução de modelo por optimização de procura\newline\alpha_1=',num2str(alpha1),' \alpha_2=',num2str(alpha2),' \delta_1=',num2str(delta1),' \delta_2=',num2str(delta2),' N_1(0)=',num2str(N1_0),' N_2(0)=',num2str(N2_0),'\newlinePonto de Equilíbrio: N_1=',num2str(-delta1/alpha1),' ; N_2=',num2str(delta2/alpha2)]);
  legend('N_2','N_2(file)');

  m=max(max(n1),max(n2))+1;
  axis([0 20 0 m]);

  xlabel('Time (t)');
  ylabel('N_1 / N_2');

  hold off;
  
 %%
 %
 % O mínimo do erro através de optimização é  12.0533 para alfa1 = 0.5715 e
 % N1(0) = 2.5740
 %
%%
%
% Os valores obtidos foram muito semelhantes para ambas as alíneas. No
% entanto, o segundo método é mais eficiente, visto que o primero envolve a
% escolha de uma grelha e diminuição da mesma por observação, e a procura
% do mínimo na matriz de erro resultante. Esta simulação com o uso dos ciclos 'for'
% é um processo demorado e com tempo de cálculo para cada matriz a evoluir 
% quadraticamente com as dimensões da mesma.
%


       

##### SOURCE END #####
--></body></html>